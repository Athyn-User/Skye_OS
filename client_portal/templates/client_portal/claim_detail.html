<!-- client_portal/templates/client_portal/claim_detail.html -->
{% extends 'client_portal/base.html' %}

{% block title %}Claim {{ claim.claim_number }} - Client Portal{% endblock %}

{% block content %}
<div class="container-fluid">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'client_portal:dashboard' %}">Dashboard</a></li>
            <li class="breadcrumb-item"><a href="{% url 'client_portal:claims' %}">Claims</a></li>
            <li class="breadcrumb-item active">{{ claim.claim_number }}</li>
        </ol>
    </nav>
    
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Claim {{ claim.claim_number }}</h2>
        <div>
            {% if claim.claim_status == 'FNOL' %}
                <span class="badge bg-danger fs-6">New</span>
            {% elif claim.claim_status == 'INVESTIGATING' %}
                <span class="badge bg-info fs-6">Under Investigation</span>
            {% elif claim.claim_status == 'APPROVED' %}
                <span class="badge bg-success fs-6">Approved</span>
            {% elif claim.claim_status == 'DENIED' %}
                <span class="badge bg-dark fs-6">Denied</span>
            {% elif claim.claim_status == 'SETTLED' %}
                <span class="badge bg-primary fs-6">Settled</span>
            {% elif claim.claim_status == 'CLOSED' %}
                <span class="badge bg-secondary fs-6">Closed</span>
            {% else %}
                <span class="badge bg-light text-dark fs-6">{{ claim.get_claim_status_display }}</span>
            {% endif %}
        </div>
    </div>
    
    <!-- Claim Information -->
    <div class="card mb-3">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Claim Information</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Claim Type:</strong> {{ claim.get_claim_type_display }}</p>
                    <p><strong>Date of Loss:</strong> {{ claim.date_of_loss|date:"F d, Y" }}</p>
                    <p><strong>Reported Date:</strong> {{ claim.reported_date|date:"F d, Y" }}</p>
                    <p><strong>Estimated Amount:</strong> ${{ claim.estimated_loss|floatformat:2 }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Adjuster:</strong> {{ claim.adjuster.get_full_name|default:"Being Assigned" }}</p>
                    <p><strong>Location:</strong> {{ claim.location_of_loss }}</p>
                    <p><strong>Cause:</strong> {{ claim.cause_of_loss }}</p>
                    {% if claim.police_report_number %}
                    <p><strong>Police Report #:</strong> {{ claim.police_report_number }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Loss Description -->
    <div class="card mb-3">
        <div class="card-header bg-info text-white">
            <h5 class="mb-0">Description of Loss</h5>
        </div>
        <div class="card-body">
            <p>{{ claim.loss_description|linebreaks }}</p>
            <div class="mt-3">
                {% if claim.injuries_reported %}
                    <span class="badge bg-danger me-2">Injuries Reported</span>
                {% endif %}
                {% if claim.property_damage %}
                    <span class="badge bg-warning">Property Damage</span>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Status Updates (Public Notes) -->
    {% if notes %}
    <div class="card mb-3">
        <div class="card-header bg-success text-white">
            <h5 class="mb-0">Status Updates</h5>
        </div>
        <div class="card-body">
            {% for note in notes %}
            <div class="border-bottom pb-3 mb-3">
                <div class="d-flex justify-content-between">
                    <h6>{{ note.subject }}</h6>
                    <small class="text-muted">{{ note.created_date|date:"M d, Y g:i A" }}</small>
                </div>
                <p class="mb-1">{{ note.content }}</p>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Related Documents -->
    {% if documents %}
    <div class="card">
        <div class="card-header bg-secondary text-white">
            <h5 class="mb-0">Related Documents</h5>
        </div>
        <div class="card-body">
            <div class="list-group">
                {% for doc in documents %}
                <a href="{% url 'client_portal:download_document' doc.id %}" class="list-group-item list-group-item-action">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1">{{ doc.name }}</h6>
                            <small>{{ doc.get_document_type_display }} - {{ doc.uploaded_date|date:"M d, Y" }}</small>
                        </div>
                        <i class="fas fa-download"></i>
                    </div>
                </a>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Contact Information -->
    <div class="card mt-3">
        <div class="card-body text-center">
            <p class="mb-2"><strong>Questions about your claim?</strong></p>
            <p class="mb-0">Contact us at (555) 123-4567 or claims@skyeinsurance.com</p>
        </div>
    </div>
</div>
{% endblock %}